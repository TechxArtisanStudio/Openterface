# **キーボードとマウスが対象のコンピュータを制御できない問題のトラブルシューティング**

時々、ユーザーは Openterface デバイスのキーボードとマウスの機能が期待通りに動作しないという状況に直面することがあります。このドキュメントでは、最も一般的な原因と、それらを解決または予防する方法について概説しています。

**ソフトウェアフィードバック：** Openterface が不足しているか間違った対象接続のため HID 通信を確立できない場合、UI はステータスを強調表示して、すぐに対応できるようにします。

- **macOS** では、Openterface ユーティリティの右上隅のキーボードとマウスアイコンが **オレンジ色** になります。  

    <img src="https://assets.openterface.com/images/software/inactive_keyboardmoue_macos.webp" alt="Inactive keyboard and mouse (macOS)" width="200" />

- **Windows/Linux** では、ウィンドウの下部にある対応するアイコンが **赤色** になります。  

    <img src="https://assets.openterface.com/images/software/inactive_keyboardmoue_windows.webp" alt="Inactive keyboard and mouse (Windows)" width="200" />

Openterface にはビデオがまだ表示されていますが、キーボードとマウスが応答しません。つまり、対象のデスクトップは見えるが制御できません。これは通常、HID 通信が確立されていないことを意味します（例：対象ケーブルが間違っている、電源が供給されていないハブ、または不良な HID チップなど）。以下のチェックリストと項目を確認してください。ソフトウェアは、配線/問題が解決されるまでキーボード/マウスの接続をさらにブロックします。

---

## **1. 不正なケーブル接続**

**問題：**  
驚くほど一般的：ユーザーが Openterface ターゲット Type-C ポートを対象のコンピュータに接続するのを忘れています。

**解決策：**  
✅ 常に確認してください：
- **ターゲット Type-C ケーブル** が Openterface の **ターゲットポート** から制御したい **対象のコンピュータ** に安全に接続されています。
- **ホスト USB-A/USB-C ケーブル** が **ホスト/制御コンピュータ** に接続されています（OpenterfaceQt または制御ソフトウェアが実行されている場所）。

> **ヒント：** 複雑なセットアップでの混乱を避けるため、ケーブルにラベルを付けてください。
- 黒いケーブルをターゲットコネクタの黒い側に接続します。
- オレンジ色のケーブルをターゲットコネクタのオレンジ色でカバーされた側に接続します。


## **2. 電源供給なし USB ハブの使用**

**問題：**  
電源供給なしの USB ハブを通じて Openterface を接続すると、**電力供給が不十分** になる可能性があります（VBUS 電圧低下）。これによりデバイスが異常に動作したり、HID（キーボード/マウス）機能の初期化に失敗したりする可能性があります。

**解決策：**  
✅ **電源供給なし USB ハブを避ける** Openterface と対象のコンピュータの間。  
✅ ハブが必要な場合は、**高品質で外部電源供給の USB ハブ** を使用し、安定した 5V 電源を供給できます。

> **注意：** USB 電力供給は HID チップの信頼性の高い動作に重要です。電圧が低下すると内部障害がトリガーされます。

---

## **3. HID チップが「ゾンビ状態」に入る**

**問題：**  
特定の条件下（例えば、高速コマンドバーストと境界電力の組み合わせ）では、内部 HID チップ（例：CH9329）が **「ゾンビ状態」に入る可能性があります。** この状態では：
- HID チップがロックされ、ホストコンピュータへのシリアル応答データの送信が停止します。
- ホストソフトウェアによる正常な再初期化を防ぐ内部エラー状態を保持します。
- デバイスは接続されている（ビデオが存在する）ように見える場合がありますが、入力は応答しません。
- ホストソフトウェア（例えば OpenterfaceQt）はデバイスを正しく再初期化できません。
- すべてのケーブルを再度挿入するか、USB 接続を電源サイクルしても、通常はこの内部エラーはクリアされません。HID チップの工場リセットが必要です。

**解決策：**  
**HID チップの工場リセット** を実行します：

- **macOS** では：macOS ユーティリティの **詳細メニュー** で利用可能な **シリアルリセットツール** を使用します。  

    <img src="https://assets.openterface.com/images/software/MacOS_FactoryResetHID.webp" alt="Serial Reset Tool (macOS)" width="150" />

- **OpenterfaceQt**（デスクトップアプリ）では：**詳細メニュー → HID チップ工場リセット** に移動します。

    <img src="https://assets.openterface.com/images/software/OpenterfaceQT_FactoryResetHID.webp" alt="Factory Reset HID Chip (OpenterfaceQt)" width="150" />

> これによりチップの内部状態がクリアされ、正常な動作が復元されます。

---

## **4. ノイズの多い環境でのボーレート感度**

**問題：**  
Openterface はデフォルトで **115200 bps** ボーレートを使用して、より高速なマウスデータ伝送を実現します。ただし、電気的にノイズの多い環境（例：スイッチングパワーサプライまたは長い/シールドされていないケーブル）では、この高いボーレートは **シリアル通信エラー** につながる可能性があり、HID コマンドの喪失または破損につながります。

**解決策：**  
**9600 bps** ボーレートに切り替えます：
- これはノイズの多いセットアップで **通信信頼性** を大幅に向上させます。
- 遅延への影響は、典型的な使用方法（例：30 FPS ビデオキャプチャと制御）では **ほぼ無視できます**。

> **推奨：** 電力または接続の問題なしに間歇的な入力グリッチが発生する場合は、Openterface の設定でボーレートを下げてみてください。

---

## **要約チェックリスト**

キーボード/マウスが機能しない場合：

1. ✅ 正しい **ターゲット Type-C ケーブル** が **対象のコンピュータ** に接続されていることを確認します。
2. ✅ 電源供給なし USB ハブを避ける—直接接続または **電源供給ハブ** を使用します。
3. ✅ デバイスが「フリーズ」しているように見える場合、ソフトウェアを通じて **HID チップをリセット** してください。
4. ✅ 不安定な環境では、**ボーレートを 9600 に低下させて** より堅牢な通信を実現します。
5. ✅ 上記の試行が役立たない場合は、ホスト上の別の USB ポートを試すか、ホストコンピュータを再起動してください。OS は多くの USB エラーパケットを受け取った後、ポートやハブを無効にする可能性があります。ポートの切り替えまたはホストの再起動は通常、接続を復元します。

---

これら 4 つの領域に対応することで、ほとんどの間歇的な HID 問題を予防または迅速に解決できます。持続的な問題については、サポート (support@openterface.com) にセットアップの詳細とログを一緒にお問い合わせください。
